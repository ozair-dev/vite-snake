var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,c=(e,t)=>{for(var n in t||(t={}))o.call(t,n)&&s(e,n,t[n]);if(r)for(var n of r(t))l.call(t,n)&&s(e,n,t[n]);return e},i=(e,r)=>t(e,n(r));import{R as a,r as u,a as d}from"./vendor.617797cb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();function m(){return a.createElement("div",{className:"Name"},a.createElement("p",null,"SNAKE"),a.createElement("p",null,"XENZIA"))}const p=e=>{const[t,n]=u.exports.useState({});u.exports.useEffect((()=>{n({gridTemplateRows:`repeat(${e.rows}, ${e.boxSize}px)`,gridTemplateColumns:`repeat(${e.columns}, ${e.boxSize}px)`})}),[e]);return a.createElement("div",{className:"Board",style:t},Array(e.boxesCount).fill(null).map(((t,n)=>{var r,o;const l=e.snakes.find((e=>e.index==n));let s=`${l?"snake":""} ${(null==l?void 0:l.direction)?l.direction:""} ${(null==(r=e.snack)?void 0:r.index)===n?"snack":""} ${(null==(o=e.bonusSnack)?void 0:o.index)===n?"bonus":""}`;return a.createElement("div",{key:n,className:"box"},a.createElement("div",{className:s}))})))};const x=e=>{let t=`${e.bonusSnack?"animate":""} ${e.delay?"":"paused"}`;return a.createElement("div",{className:"stats"},a.createElement("div",{className:"duration"},a.createElement("div",{className:t})),a.createElement("p",null,"Highscore: ",e.score.high),a.createElement("p",null,"Score: ",e.score.current))};const f=e=>{let t=u.exports.useRef(null);const[n,r]=u.exports.useState([]),[o,l]=u.exports.useState(),[s,d]=u.exports.useState(null),[m,f]=u.exports.useState(10),[h,g]=u.exports.useState(80),[b,E]=u.exports.useState(["right"]),[v,S]=u.exports.useState(!1),[y,k]=u.exports.useState({boxesCount:0,rows:0,boxSize:0,columns:15}),[N,w]=u.exports.useState({current:0,high:0}),[O,$]=u.exports.useState(!1),C={up:-y.columns,down:y.columns,left:-1,right:1},j=e=>{r(e.map(((t,n)=>(e[n+1]?t.index=e[n+1].index:(t.direction=b[b.length-1],b.length>1&&E((e=>e.slice(0,e.length-1))),t.index+=C[t.direction],t=(e=>{switch(!0){case e.index%y.columns==0&&"right"===e.direction:e.index-=y.columns;break;case(e.index%y.columns==y.columns-1||-1===e.index)&&"left"===e.direction:e.index+=y.columns;break;case e.index>=y.boxesCount||e.index<0:e.index=Math.abs(y.boxesCount-Math.abs(e.index))}return e})(t)),t))))},I=()=>{h?g(null):(O&&(w((e=>(e.current=0,e))),E(["right"]),d(null),f(10),A(y.boxesCount),z(),$(!1)),g(80))},M=()=>{w((e=>{let t=e.current+1;return{current:t,high:t>e.high?t:e.high}})),z(),r((e=>[{},...e]))},L=()=>{let e,t=n[n.length-1];for(let r=0;r<n.length;r++)if(t.index===n[r].index&&n[r]!==t){e=n[r];break}e&&(g(null),$(!0),localStorage.setItem("highscore",N.high)),o.index===t.index&&M(),t.index===(null==s?void 0:s.index)&&(w((e=>{let t=e.current+5;return{current:t,high:t}})),d(null),f((e=>e+5)))},P=()=>Math.floor(Math.random()*y.boxesCount),A=e=>{r([{index:Math.floor(e/2),direction:b[b.length-1]}])},z=()=>{const e=P();l({index:e})},R=e=>{let t=e.code.slice(5).toLowerCase();C[t]?(e=>{const t=[["up","down"],["left","right"]].find((e=>e.includes(b[0])));!(null==t?void 0:t.includes(e))&&h&&E((t=>{let n;return v?n=[e,...t]:(n=[e],S(!0)),n}))})(t):"Space"===e.code&&I()};return function(e,t){const n=u.exports.useRef();u.exports.useEffect((()=>{n.current=e}),[e]),u.exports.useEffect((()=>{function e(){n.current()}if(null!==t){let n=setInterval(e,t);return()=>clearInterval(n)}}),[t])}((()=>{let e=n.slice();j(e),L(),m!==N.current||s?s&&d((e=>{let t=(null==e?void 0:e.duration)-80;return t>0?i(c({},e),{duration:t}):null})):(()=>{const e=P();d({index:e,duration:5e3}),f(N.current+10)})(),S(!1)}),h),u.exports.useEffect((()=>{let{clientWidth:e,clientHeight:n}=t.current;n=90*n/100;const{columns:r}=y,o=e/r,l=Math.floor(n/o),s=r*l;k(Object.assign({},y,{boxesCount:s,boxSize:o,rows:l})),A(s);let c=JSON.parse(localStorage.getItem("highscore"));c&&w((e=>(e.high=c,e))),z()}),[]),u.exports.useEffect((()=>(document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R))),[h,b,o,s,v,O,m]),a.createElement("div",{ref:t,className:"Game"},a.createElement(p,i(c({},y),{snakes:n,snack:o,bonusSnack:s})),a.createElement(x,{score:N,delay:h,bonusSnack:s}))};function h(){return a.createElement("div",{className:"App"},a.createElement(m,null),a.createElement(f,null))}d.render(a.createElement(a.StrictMode,null,a.createElement(h,null)),document.getElementById("root"));
